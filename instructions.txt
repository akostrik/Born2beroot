iSCSI = Internet Small Computer System Interface
Протокол для установления взаимодействия и управления системами хранения данных, серверами и клиентами
Базируется на TCP/IP
Позволяет двум хостам согласовать соединение и после этого обмениваться командами SCSI с помощью интернет протокола (IP)

SELinux doit rester actif 
SELinux = Security-Enhanced Linux : Architecture de securite
Definit les controles d'acces pour les applications, processus et fichiers d'un systeme
A chaque requete generee par un utilisateur, SELinux consulte un cache ou sont stockees les autorisations pour les sujets et objets
Ces autorisations peuvent etre differentes a chaque maille / sous-maille (MLS : Multi level security
Принудительный контроль доступа, может работать параллельно с классической избирательной системой контроля доступа (rwx)
Права определяются системой на уровне системных вызовов и применяются ядром (но можно реализовать и на уровне приложения)
Нельзя разрешить то, что запрещено через права доступа пользователей или групп

AppArmor doit rester actif
Associer a chaque programme un profil de securite qui restreint acces aux systeme d'exploitations
Il est en complement du systeme de controle d'acces Linux en permettant d'utiliser le MAC : Mandatory Access control
Permet un mode d'aprentissage
Difference avec SELinux : travaille avec les chemins alors que SELinux s'appuie sur l'application d'indicateurs aux fichiers
Программный инструмент упреждающей защиты, основанный на политиках (профилях) безопасности - к каким системным ресурсам и с какими привилегиями может получить доступ приложение

Diff between aptitude and apt
Aptitude is a high-level package manager while APT is lower-level package manager which can be used by other 
higher-level package managers
(read more: https://www.tecmint.com/difference-between-apt-and-aptitude/)

2 partitions chiffrees avec LVM
$ lsblk -> shows the partitions 
название устройства : MAJ MIN старший и младший номера устройств : RM 1 съемное : RО 1 только для чтения : диск/уст-во обратной связи/раздел/уст-во LVM
Первый обнаруженный жёсткий диск называется /dev/sda, второй /dev/sdb, ...
Первый SCSI CD-ROM называется /dev/scd0, также можно использовать /dev/sr0

Service SSH (Secure Shell) sur le port 4242 uniquement
Authentification sans mot de passe ou phrase secerete mais avec des cles
Как бы работаете непосредственно на той машине
La cle publique est distribuee sur les systemes auxquels on souhaite authorises l'acces
La cle privee, unique pour chaque utilisateur et proteger par un mot de passe, est uniquement presente sur le poste en question; on parle d'agent ssh pour stocker la cle privee
* /etc/ssh/sshd_config Port 4242					
* /etc/ssh/sshd_config PermitRootLogin		pas possible de se connecter a SSH avec root
* перезагрузить SSH-сервер: /etc/init.d/ssh restart, или ./sshrestart или /etc/init.d/sshd restart, или systemctl restart sshd.service
$ systemctl status sshd										tester
$ grep Port /etc/ssh/sshd_config					tester
$ service ssh status					
$ ssh kostrik@127.0.0.1 -p 4242						connect to VM from your host (physical) machine via SSH
* ssh p4242 127.0.0.1
$ sudo apt-get updates										install sudo
$ sudo apt install openssh-server
$ service ssh restart

Un pare-feu UFW (Uncomplicated Firewall)
Le trafic entrant est refuse et le trafic sortant est autorise (reglage)
$ apt update -y install
$ apt install ufw -y install
* /etc/default/ufw IPV6=yes
$ ufw default allow									autorise le trafic entrant
$ ufw default deny									refuse le trafic entrant 
$ ufw default allow (deny) ongoing	autorise (refuse) le trafic sortant
$ ufw allow 4242										ne laisser que le port 4242 ouvert
$ ufw deny 8080							
$ ufw enable
$ ufw status numbered
$ ufw delete 4 (правило 4)
$ ufw allow ssh
$ dpkg -l | grep ufw

hostname = akostrik42
$ hostname
$ hostnamectl ОС
$ hostnamectl set-hostname поменять постоянно
* etc/hostname и /etc/hosts поменять постоянно
$ sudo reboot
$ hostname akostrik43 поменять временно
* /etc/hostname

pam = pluggable authentification method, a flexible authentication mechanism used by the application software
1) Normal Unix authentication pam_unix under PAM (/etc/passwd /etc/shadow /etc/group)
2) Strong password policy :
$ sudo apt-get install libpam-pwquality							installing password quality checking library
/etc/pam.d/common-password:
  -> password requisite pam_pwquality.so retry=3 lcredit =-1 ucredit=-1 dcredit=-1 maxrepeat=3 usercheck=0 difok=7 enforce_for_root
    // basic checks
    // dcredit=-1 credit=-1 credit=-1 contain an uppercase letter, a lowercase letter, and a number
    // maxrepeat=3 pas plus de 3 caracteres consecutifs
    // usercheck=1 ne doit pas contenir le nom de l'utilisateur
    // difok=7 <=7 characters that are not part of the former password 
    // enforce_for_root															apply to the root password
    // inclass=3 ?
  -> password [success=2 default=ignore] pam_unix.so obscure sha512 minlen=10
    // checking users password, default = not permit the user access to a service if their official password is blank
  -> password required pam_deny.so
  -> password required pam_permit.so
/etc/login.defs PASS_MAX_DAYS 30j										expire tous les 30j, 2j minimum pour modifier, un avertissement 7j
/etc/pam.d/passwd ?
$ sudo reboot

Installer, configurer sudo 
TTY : requiretty = a non-root code (ex, PHP script) won't be able to directly upgrade its privileges by running sudo
$ su -												install sudo
$ apt update
$ apt-get update -y
$ apt-get upgrade -y
$ apt install sudo
$ cat log 										Input log
$ cat ttyout									Output log
$ visudo -> akostrik ALL=(ALL) ALL sudoers file
* /etc/sudoers :
  Defaults secure_path="...",
  Defaults passwd_tries=30 											3 essais pour sudo maximum
  Defaults badpass_message="Password is wrong" 	a custom message pour un mauvais mdp avec sudo
  Defaults logfile="/var/log/sudo/sudo.log" 		chaque action avec sudo est archivée (create file if need)
  Defaults log_input,log_output
  Defaults requiretty 													mode TTY activé
  Defaults secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin" restricttion the paths used by sudo
/var/log/sudo/00/00 													sudo logs
$ chage -l akostrik				tester

Un utilisateur appartient au groupe akostrik42 et sudo: login = akostrik42, pwd = root
$ useradd akostrik 						create user
$ /usr/bin/groupadd						akostrik42 create group 
$ usermod -ahostnaG akostrik	adds the user to the group
$ /usr/sbin/usermod -a -G akostrik (пользователю выйти / войти)
$ passwd akostrik 						define password for a user 
* /etc/passwd 								list of users
$ groups akostrik 						tester
$ groups 											tester
$ id -Gn akostrik 						tester
* /etc/sudoers.d 							?
ПАРОЛЬ akostrik iopiopiopiop

Script SH :
• The architecture of your operating system and its kernel version
• The number of physical processors
• The number of virtual processors
• The current available RAM on your server and its utilization rate as a percentage
• The current available memory on your server and its utilization rate as a percentage
• The current utilization rate of your processors as a percentage
• The date and time of the last reboot
• Whether LVM is active or not
• The number of active connections
• The number of users using the server
• The IPv4 address of your server and its MAC (Media Access Control) address
• The number of commands executed with the sudo program
$ apt-get install sysstat -> necessaire pour l'affichage des CPU, dDisk et autres performances
create /usr/local/bin/monitoring.sh
$ sudo visudo:
your_username ALL=(ALL) NOPASSWD: /usr/local/bin/monitoring.sh -> the script execute without sudo pass
$ sudo reboot
$ sudo /usr/local/bin/monitoring.sh - выполнить скрипт
$ sudo crontab -u root -e
$ sudo crontab -e
*/10 * * * * /usr/local/bin/monitoring.sh
*/1 * * * * sleep 30s && /usr/local/bin/monitoring.sh
// if error when you reboot, change the Display settings $ drm:vmw_host_log *ERROR* Failed to send host log message.

Liens utils :
https://tbonelee.tistory.com/m/16
https://coagul.org/drupal/publication/commandes-avanc%C3%A9es-sous-linux
https://www.youtube.com/watch?v=OQEdjt38ZJA

Commandes utiles : 
$ ls -Z -> liste les attributs étendus (lien avec SELinux)
$ sudo apt update -> update apt 
$ mkfs
$ fdisk
$ netstat -tupln | grep LISTEN			какие порты прослушиваются 
$ ss -lntu													какие порты прослушиваются 
$ nmap (установить)									какие порты прослушиваются 
$ lsof -i 													какие порты прослушиваются 

/etc/apt/sources.list -> a modifier
